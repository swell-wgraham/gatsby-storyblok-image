var t,e=require("path"),a=(t=e)&&"object"==typeof t&&"default"in t?t.default:t,s=/^(https?:)?\/\/a.storyblok.com\/f\/[0-9]+\/[0-9]+x[0-9]+\/[A-Za-z0-9]+\/[\S]+\.[a-z]+/;function i(t){var e=null,a=null;if("string"==typeof t&&(e=t),"object"==typeof t&&("asset"===t.fieldtype?e=t.filename:(e=t.image,a=t.base64?t.base64:null)),!(e=s.test(e)?e:null))return!1;var i=e.replace(/^(https?:)?\/\/a.storyblok.com\//,""),r=i.split("/"),n=r[4],o=r[2].split("x").map(function(t){return parseInt(t,10)}),l=o[0],c=o[1];return{originalPath:i,extension:n.split(".")[1],metadata:{dimensions:{width:l,height:c,aspectRatio:l/c},lqip:a}}}var r="https://img2.storyblok.com",n=a.resolve(".cache/storyblok/assets/"),o=[1,1.5,2,3],l=[.25,.5,1,1.5,2,3],c={quality:100,smartCrop:!0,format:null,fill:null,toFormat:null,base64:null,useBase64:!0},u=Object.assign({},c,{maxWidth:800,maxHeight:null}),p=Object.assign({},c,{width:400,height:null});function b(t){var e=t.includes("filters:format(webp)"),a=/[a-f0-9]+-\d+x\d+\.webp/.test(t);return e||a}function h(t,e){return void 0===e&&(e=""),t.map(function(t){var a=t.split(" "),s=a[1];return"/static/"+s+"--"+a[0].split("/").slice(-1)+e+" "+s}).join(",\n")}function f(t,e){var a=e.width,s=e.height,i=e.smartCrop,n=e.quality,o=e.format,l=e.fill,c=t.split("."),u=r;a&&s&&(u+="/"+a+"x"+s),i&&(u+="/smart");var p=[n&&"quality("+n+")",o&&o!==c[1]&&"format("+o+")",l&&"fill("+l+")"];return(p=p.filter(function(t){return!0===Boolean(t)})).length>0&&(u+=function(t){return t.reduce(function(t,e,a){return t+":"+e},"/filters")}(p)),u+"/"+t}function m(t){var a=t.imageName,s=t.src,i=t.srcWebp,r=t.srcSets;if("undefined"==typeof window){var o=require("fs-extra"),l=e.resolve(n+"/"+a);o.pathExists(l+".json").then(function(t){t||o.writeJsonSync(l+".json",{name:a,src:s,srcSet:r.base,srcWebp:i,srcSetWebp:r.webp})})}}exports.getFixedGatsbyImage=function(t,e){void 0===e&&(e={});var a=i(t);if(!a)return null;var s=Object.assign({},p,e),r=s.width,n=s.height,l=a.metadata.dimensions,c=a.originalPath,u=l.aspectRatio;s.height&&(u=r/s.height);var d=null;s.toFormat?d=s.toFormat:b(c)&&(d="jpg");var g,w,v,j,x=o.map(function(t){return Math.round(r*t)}).filter(function(t){return t<l.width}).reduce(function(t,e,a){var i=o[a]+"x",r=Math.round(e/u),n=Object.assign({},s,{width:e,height:r}),l=f(c,Object.assign({},n,{format:"webp"})),p=f(c,Object.assign({},n,d&&{format:d}));return t.webp.push(l+" "+i),t.base.push(p+" "+i),t},{webp:[],base:[]}),O=Math.round(n||r/u),y=Object.assign({},s,{width:r,height:O}),S=f(c,Object.assign({},y,d&&{format:d})),W=f(c,Object.assign({},y,{format:"webp"}));if("production"===process.env.NODE_ENV&&s.saveLocal){var F=S.split(" ")[0].split("/").slice(-1);m({imageName:F,src:S,srcSets:x,srcWebp:W}),g="/static/"+F,w=h(x.base),v="/static/"+F+".webp",j=h(x.base,".webp")}else g=S,w=x.base.join(",\n")||null,v=W,j=x.webp.join(",\n")||null;return{base64:t.base64||null,aspectRatio:u,width:Math.round(r),height:O,src:g,srcSet:w,srcWebp:v,srcSetWebp:j}},exports.getFluidGatsbyImage=function(t,e){void 0===e&&(e={});var a=i(t);if(!a)return null;var s=Object.assign({},u,e),r=s.maxWidth,n=a.metadata.dimensions,o=a.originalPath,c=n.aspectRatio;s.maxHeight&&(c=r/s.maxHeight);var p=s.maxHeight||Math.round(r/n.aspectRatio),d=null;s.toFormat?d=s.toFormat:b(o)&&(d="jpg");var g,w,v,j,x=s.sizes||"(max-width: "+r+"px) 100vw, "+r+"px",O=l.map(function(t){return Math.round(r*t)}).filter(function(t){return t<n.width}).concat(n.width).filter(function(t){return t<n.width}).reduce(function(t,e){var a={width:e,height:Math.round(e/c)},i=f(o,Object.assign({},s,a,{format:"webp"})),r=f(o,Object.assign({},s,a,{format:d}));return t.webp.push(i+" "+e+"w"),t.base.push(r+" "+e+"w"),t},{webp:[],base:[]}),y={width:r,height:p},S=f(o,Object.assign({},s,y,{format:d})),W=f(o,Object.assign({},s,y,{format:"webp"}));if("production"===process.env.NODE_ENV&&s.saveLocal){var F=S.split(" ")[0].split("/").slice(-1);m({imageName:F,src:S,srcSets:O,srcWebp:W}),g="/static/"+F,w=h(O.base),v="/static/"+F+".webp",j=h(O.base,".webp")}else g=S,w=O.base.join(",\n")||null,v=W,j=O.webp.join(",\n")||null;return{base64:t.base64||null,aspectRatio:c,src:g,srcSet:w,srcWebp:v,srcSetWebp:j,sizes:x}};
//# sourceMappingURL=index.js.map
